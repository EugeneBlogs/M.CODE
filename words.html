<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <title>Загадай-Угадай</title>
</head>

<body class="text-center">
    <div id="load_header"></div>
    <section class="pt-5">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <h3 class="text-danger">Загадай-Угадай</h3>
                    <p>Игра расчитана на двух человек.<br>Первый человек загадывает слово, а второй
                        должен будет по буквам угадать его за 7 попыток.</p>
                </div>
                <div class="col-12 border border-success p-5" id="player1">
                    <h3>Игрок 1, загадайте слово.</h3>
                    <h6 class="text-start text-danger">ВНИМАНИЕ! МОЖНО ВВОДИТЬ РУССКИЕ/АНГЛИЙСКИЕ БУКВЫ И ЦИФРЫ. СИМВОЛЫ
                        НЕ ПОДДЕРЖИВАЮТСЯ! СЛОВ МОЖЕТ БЫТЬ НЕСКОЛЬКО!</h6>
                    <div class="form-floating mt-3">
                        <input style="background-color: black;" class="form-control text-warning" placeholder="Слово"
                            id="word" />
                        <label for="word">Слово</label>
                    </div>
                    <div class="form-floating mt-3">
                        <input style="background-color: black;" class="form-control text-warning"
                            placeholder="Категория" id="category" />
                        <label for="category">Категория</label>
                    </div>
                    <a class="btn text-danger mt-3" href="#" onclick="StartGame()">Начать игру</a>
                </div>
                <div class="col-12 border border-danger p-5" id="player2" style="display: none;">
                    <h3>Игрок 2, отгадывайте слово.</h3>
                    <div class="text-start">
                        <h6><span class="text-primary">Количество попыток:</span> <span id="attempts_player2">7</span>.
                        </h6>
                        <h6><span class="text-success">Категория:</span> <span id="category_player2">?</span>.</h6>
                        <h6><span class="text-info">Информация:</span> <span id="letters_player2">?</span></h6>
                        <h6><span class="text-warning">Слово:</span> <span id="word_player2">?</span>.</h6>
                    </div>
                    <div class="form-floating mt-3">
                        <select class="form-select bg-dark text-light" id="letter">
                            <option value="А">А</option>
                            <option value="Б">Б</option>
                            <option value="В">В</option>
                            <option value="Г">Г</option>
                            <option value="Д">Д</option>
                            <option value="Е">Е</option>
                            <option value="Ё">Ё</option>
                            <option value="Ж">Ж</option>
                            <option value="З">З</option>
                            <option value="И">И</option>
                            <option value="Й">Й</option>
                            <option value="К">К</option>
                            <option value="Л">Л</option>
                            <option value="М">М</option>
                            <option value="Н">Н</option>
                            <option value="О">О</option>
                            <option value="П">П</option>
                            <option value="Р">Р</option>
                            <option value="С">С</option>
                            <option value="Т">Т</option>
                            <option value="У">У</option>
                            <option value="Ф">Ф</option>
                            <option value="Х">Х</option>
                            <option value="Ц">Ц</option>
                            <option value="Ч">Ч</option>
                            <option value="Ш">Ш</option>
                            <option value="Щ">Щ</option>
                            <option value="Ъ">Ъ</option>
                            <option value="Ы">Ы</option>
                            <option value="Ь">Ь</option>
                            <option value="Э">Э</option>
                            <option value="Ю">Ю</option>
                            <option value="Я">Я</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                            <option value="F">F</option>
                            <option value="G">G</option>
                            <option value="H">H</option>
                            <option value="I">I</option>
                            <option value="J">J</option>
                            <option value="K">K</option>
                            <option value="L">L</option>
                            <option value="M">M</option>
                            <option value="N">N</option>
                            <option value="O">O</option>
                            <option value="P">P</option>
                            <option value="Q">Q</option>
                            <option value="R">R</option>
                            <option value="S">S</option>
                            <option value="T">T</option>
                            <option value="U">U</option>
                            <option value="V">V</option>
                            <option value="W">W</option>
                            <option value="X">X</option>
                            <option value="Y">Y</option>
                            <option value="Z">Z</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                        </select>
                    </div>
                    <a class="btn text-danger mt-3" href="#" onclick="Check()">Проверить букву</a>
                </div>
            </div>
        </div>
    </section>
    <div class="position-fixed bottom-0 start-50 translate-middle-x p-3 toast-container" style="z-index: 11;">
        <div id="yes" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-body bg-success text-light" style="font-size: 30px;">
                Такая буква есть!
            </div>
        </div>
    </div>
    <div class="position-fixed bottom-0 start-50 translate-middle-x p-3 toast-container" style="z-index: 11;">
        <div id="no" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-body bg-danger text-light" style="font-size: 30px;">
                Такой буквы нет!
            </div>
        </div>
    </div>
    <div id="load_footer"></div>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery-1.4.2.min.js"></script>
    <script src="js/jquery.bubble.text.min.js"></script>
    <script src="js/basic_elements.js"></script>
    <script>
        let stay_attempt = 7;
        let correct_word = ""
        let now_word = ""
        let was_letters = []
        function StartGame() {
            correct_word = document.getElementById("word").value.replace(/[^а-яёА-ЯЁA-Za-z0-9 ]/g, "").replace(/ +/g, ' ').toUpperCase()
            if (correct_word.length > 0) {
                for (let i = 0; i < correct_word.length; i++) {
                    if (correct_word[i] == " ") {
                        now_word += " "
                    } else {
                        now_word += "?"
                    }
                }
                let rus_letters = 0
                let eng_letters = 0
                let num_letters = 0
                let space = 0
                let words_result = 0
                for (let i = 0; i < correct_word.length; i++) {
                    if (correct_word[i] == " ") {
                        space++
                    } else if (correct_word[i] == "0" || correct_word[i] == "1" || correct_word[i] == "2" || correct_word[i] == "3" || correct_word[i] == "4" || correct_word[i] == "5" || correct_word[i] == "6" || correct_word[i] == "7" || correct_word[i] == "8" || correct_word[i] == "9") {
                        num_letters++
                    } else {
                        if (correct_word.charCodeAt(i) >= 1040 && correct_word.charCodeAt(i) <= 1103) {
                            rus_letters++;
                        } else {
                            eng_letters++
                        }
                    }
                }
                words_result = space + 1
                document.getElementById("letters_player2").innerHTML =
                    `
        <br><span class="text-danger">Русские буквы:</span> ${rus_letters}.
        <br><span class="text-danger">Английские буквы:</span> ${eng_letters}.
        <br><span class="text-danger">Цифры:</span> ${num_letters}.
        <br><span class="text-danger">Пробелы:</span> ${space}.
        <br><span class="text-danger">Слова:</span> ${words_result}.
        `
                document.getElementById("category_player2").innerHTML = document.getElementById("category").value
                document.getElementById("word_player2").innerHTML = now_word
                document.getElementById("player1").style.display = "none"
                document.getElementById("player2").style.display = "block"
            } else {
                alert("Введите слово!")
            }
        }
        function Check() {
            let now_letter = document.getElementById("letter").value
            if (now_letter.length != 1) {
                alert("Выберете одну букву/цифру!")
            } else {
                if (!was_letters.includes(now_letter)) {
                    was_letters.push(now_letter)
                    var indices = [];
                    for (let i = 0; i < correct_word.length; i++) {
                        if (correct_word[i] === now_letter) indices.push(i)
                    }
                    if (indices.length != 0) {
                        for (let i = 0; i < indices.length; i++) {
                            now_word = now_word.replaceAt(indices[i], now_letter)
                        }
                        document.getElementById("word_player2").innerHTML = now_word
                        var toast = new bootstrap.Toast(document.getElementById("yes"))
                        toast.show()
                        if (!now_word.includes("?")) {
                            alert(`Поздравляем, вы угадали! Игрок загадал слово '${correct_word}'.`)
                            location.reload();
                        }
                    } else {
                        stay_attempt--
                        document.getElementById("attempts_player2").innerHTML = stay_attempt
                        var toast = new bootstrap.Toast(document.getElementById("no"))
                        toast.show()
                        if (stay_attempt == 0) {
                            alert(`К сожалению, вы проиграли! Игрок загадал слово '${correct_word}'.`)
                            location.reload();
                        }
                    }
                } else {
                    alert("Вы уже называли эту букву/цифру! Попробуйте другую!")
                }
                document.getElementById("letter").value = ""
            }
        }
        String.prototype.replaceAt = function (index, replacement) {
            if (index >= this.length) {
                return this.valueOf();
            }
            var chars = this.split('');
            chars[index] = replacement;
            return chars.join('');
        }
    </script>
</body>

</html>